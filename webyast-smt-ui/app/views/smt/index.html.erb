<!--
# Copyright (c) 2010 Novell, Inc.
# 
# All Rights Reserved.
# 
# This program is free software; you can redistribute it and/or modify it
# under the terms of version 2 of the GNU General Public License
# as published by the Free Software Foundation.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; if not, contact Novell, Inc.
# 
# To contact Novell about this file by physical or electronic mail,
# you may find current contact information at www.novell.com
-->

<% content_for :head do %>
  <%= javascript_include_tag :defaults %>
  <%= javascript_include_tag "digitalspaghetti.password.js" %>

  <style type="text/css">
    label.error { float: none; padding-left: 10em }
    div#password-strength { width: 25em; margin-left: -2em }
  </style>

  <%= javascript_include_tag "validation.js" %>
  <script type="text/javascript">
    $(document).ready(function() {
      $("#smt_form").validate({
        rules: {
          smt_mirror_to: {
            required:true
          }
        },
        messages: {
          smt_mirror_to: {
            required: "<%= _("Hey dude, where is mirror path?") %>"
          }
        }
      })
      $("#mirror_to").keyup( function(){ $("#smt_form").valid();});
      $("#smt_form").valid();
    })
  </script>
   
   <style type="text/css">   label.error { 
      float:none; 
      display:inline; 
      font-weight:bold; 
      color:#990000; 
      padding-left:.5em; 
      vertical-align:middle; 
     } 
     label.valid { 
      background: url('../images/checked.gif') no-repeat; 
      padding:0px 0px 0px 18px; 
      vertical-align:middle; 
      margin-left:5px; 
     } 
    </style>

<% end %>

<% disabled = !@permissions[:write] %>

<div class="nav-buttons">
  <% if !disabled -%>
  <div id="progress" style="display: none; margin-bottom: 10px"><img src="/images/working.gif" alt="Working"/><span style="vertical-align: 50%; margin-left: 5px">...Wait...</span></div>
  <% end -%>
</div>

  <div class='plugin-icon'><img src='/icons/yast-online_update.png'/> <%= _("SMT") %></div>
  <div class='plugin-content'>

    <% form_for(:smt, @smt, :url => { :action => 'update' },
      :html => { :method => :put, :id => 'smt_form' }
    ) do |f| %>

	  <div class="smt-content" style="padding-bottom: 10px">
	    <p>
	      <%= check_box_tag 'service_running', true, @smt.status, :disabled => disabled, :name => 'smt[status]' -%>
	      <%= _("Enable SMT") %>
	    </p>
            <p>
              <%= label_tag :smt_mirror_to, _("Mirror To") %>
              <%= text_field_tag :smt_mirror_to, @smt.credentials.LOCAL.MirrorTo, :disabled => disabled, :class => 'required', :name => 'smt[credentials][LOCAL][MirrorTo]'  %>
            </p>
            <p>
              <%= submit_tag %>
            </p>

    <% end %>

  </div>
